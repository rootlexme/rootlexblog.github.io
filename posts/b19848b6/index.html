<!DOCTYPE html><html lang="zh-CN"><head><title>Artalk部署教程</title><noscript>开启Javascript是必要的</noscript><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="ai: 这篇文章介绍了如何通过Docker和CADDY来部署Artalk评论系统。首先介绍了Docker和CADDY的安装方法，然后详细说明了如何使用Docker来安装和启动Artalk，并开放端口进行访问。最后介绍了如何使用CADDY进行反代并访问。文章还解答了为什么不用宝塔、Nginx或Apache这些老牌站点管理器，以及为什么选择Artalk的原因。"><meta aria-keyshortcuts="Rootlex, blog, 技术, 博客"><link href="https://cdn1.tianli0.top/npm/remixicon@3.2.0/fonts/remixicon.css" rel="stylesheet"><link href="/css/var.css" rel="stylesheet"><link href="/css/main.css" rel="stylesheet"><link href="/css/content.css" rel="stylesheet"><script src="/js/lib/pace.min.js"></script><link href="/css/hightlight/theme.css" rel="stylesheet"><script>var GLOBALCONFIG={root:"/",lazyload:{enable:!0,error:"https://cdn.skypro.cartafi.cn/2023/05/02/topimg.webp"},codelimit:300,lightbox:!0}</script><script id="site-config">var PAGECONFIG={is_home:!1,is_post:!0,is_page:!1,page:!1,comments:!0}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Rootlex Blog" type="application/atom+xml"></head><body><main class="layouts_warp"><div class="layouts_content"><div class="sidebar_main w-1-3" id="sidebar"><div class="site_name"><img src="/img/site.png" alt="网页标题" class="nolazyload"></div><ul class="menu" id="menu"><li class="menu_list"><a href="/" class="menu_item"><i class="ri-home-6-line"></i> <span class="menu_item_span">主页</span></a></li><li class="menu_list"><a href="/posts/" class="menu_item"><i class="ri-article-line"></i> <span class="menu_item_span">文章</span></a></li><li class="menu_list"><a href="/bgm/" class="menu_item"><i class="ri-movie-2-line"></i> <span class="menu_item_span">追番</span></a></li><li class="menu_list"><a href="/link/" class="menu_item"><i class="ri-links-line"></i> <span class="menu_item_span">朋友们</span></a></li><li class="menu_list"><a href="/me/" class="menu_item"><i class="ri-heart-line"></i> <span class="menu_item_span">关于我</span></a></li></ul><hr><div class="tab_warp"><input type="radio" name="side-tab" class="tab-radio-tj" id="card-selector-tj" checked> <input type="radio" name="side-tab" class="tab-radio-toc" id="card-selector-toc"><div class="tab_selector"><label for="card-selector-tj" class="tab-handler-tj">统计</label> <label for="card-selector-toc" class="tab-handler-toc">目录</label></div><div class="tab_content"><div class="tab_content-tj"><div class="statistics_item"><span class="statistics_span">文章</span> <span class="statistics_num">9 篇</span></div><div class="statistics_item"><span class="statistics_span">分类</span> <span class="statistics_num">3</span></div><div class="statistics_item"><span class="statistics_span">字数</span> <span class="statistics_num">7.8k</span></div><div class="statistics_item"><span class="statistics_span">运行</span> <span class="statistics_num">440 天</span></div></div><div class="tab_content-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Docker%E7%8E%AF%E5%A2%83"><span class="toc-text">安装Docker环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Caddy"><span class="toc-text">安装Caddy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Artalk"><span class="toc-text">安装Artalk</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Caddy%E8%BF%9B%E8%A1%8C%E5%8F%8D%E4%BB%A3"><span class="toc-text">使用Caddy进行反代</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="toc-text">写在最后</span></a></li></ol></div></div></div><div class="connect"><a target="_blank" rel="noopener" href="https://space.bilibili.com/494271806" style="color:#00b1ff" aria-label="bilibili"><i class="ri-bilibili-fill"></i></a><a target="_blank" rel="noopener" href="https://github.com/rootlexblog" style="color:#000" aria-label="github"><i class="ri-github-fill"></i></a><a target="_blank" rel="noopener" href="https://music.163.com/#/user/home?id=3416536539" style="color:#ff3030" aria-label="网易云"><i class="ri-netease-cloud-music-fill"></i></a><a href="mailto:a@nalex.top" style="color:#ffc952" aria-label="邮箱"><i class="ri-mail-send-line"></i></a></div><div class="sidebar_footer"><div class="link"><a href="/privacy">隐私协议</a> <a href="/cc">版权声明</a></div><div class="link"><i class="ri-copyright-line"></i> <span>2023</span> <a href="/">Rootlex</a></div></div></div><div class="layouts_page_content w-2-3"><div class="nav hide" id="nav"><div class="nav_item"><a href="/" aria-label="主页" class="home"><i class="ri-home-6-line"></i></a><a class="rand_page" aria-label="随机页面" onclick="toRandomPost()"><i class="ri-shuffle-line"></i></a><div class="mobile_nav_item"><a class="menu_item" href="/" aria-label="主页"><i class="ri-home-6-line"></i></a><a class="menu_item" href="/posts/" aria-label="文章"><i class="ri-article-line"></i></a><a class="menu_item" href="/bgm/" aria-label="追番"><i class="ri-movie-2-line"></i></a><a class="menu_item" href="/link/" aria-label="朋友们"><i class="ri-links-line"></i></a><a class="menu_item" href="/me/" aria-label="关于我"><i class="ri-heart-line"></i></a></div></div><div class="nav_item"><a href="/atom.xml" aria-label="rss" target="_blank"><i class="ri-rss-fill"></i></a><a target="_blank" rel="noopener" href="https://www.travellings.cn/go.html" aria-label="开往"><i class="ri-subway-fill"></i></a></div></div><div class="content_top"><div class="top_img"><img src="https://cdn.skypro.cartafi.cn/2023/05/02/topimg.webp" alt="顶部头图" class="top_img_bg nolazyload"><div class="me"><span>Rootlex</span> <img src="https://cdn.skypro.cartafi.cn/2023/05/02/avatar.webp" alt="头像" class="avatar nolazyload"></div></div><div class="top_bar"><div class="cate_list" id="cate"><a class="cate_item" href="/">主页</a><div class="cate_list_item"><a class="cate_item" href="/categories/教程/">教程</a> <a class="cate_item" href="/categories/笔记/">笔记</a> <a class="cate_item" href="/categories/折腾/">折腾</a></div></div><div class="bar_dec"><span>寒蝉黎明之时，便是重生之日</span></div></div></div><div class="index_content"><div class="index_content_list_item"><div class="post_info">Artalk部署教程</div><div class="content_g"><html><head></head><body><h2 id="安装Docker环境"><a href="#安装Docker环境" class="headerlink" title="安装Docker环境"></a>安装Docker环境</h2><p>Docker是一个开源的应用容器引擎，我们可以使用它部署并运行Artalk。Docker安装很简单我们可以使用一键安装脚本，这里以Ubuntu为例，在命令行输入</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://get.docker.com <span class="token operator">|</span> <span class="token function">bash</span> <span class="token parameter variable">-s</span> <span class="token function">docker</span> <span class="token parameter variable">--mirror</span> Aliyun</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p>安装完成后在命令行输入</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token parameter variable">-v</span> </code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/01/30/63d70e78ed0e2.webp" alt="docker-v"></p><p>检查Docker是否成功安装，如果成功输出Docker版本那就说明安装成功了！</p><h2 id="安装Caddy"><a href="#安装Caddy" class="headerlink" title="安装Caddy"></a>安装Caddy</h2><p>Caddy是一款基于Go语言编写的强大且可扩展的平台，可以给你的站点、服务和应用程序提供服务。使用Caddy我们可以很容易实现反代功能，并且Caddy会根据域名自动帮您签发SSL证书。Caddy安装比Docker安装相对复杂一些，我们需要在命令行运行一下命令</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> debian-keyring debian-archive-keyring apt-transport-https
<span class="token function">curl</span> <span class="token parameter variable">-1sLf</span> <span class="token string">'https://dl.cloudsmith.io/public/caddy/stable/gpg.key'</span> <span class="token operator">|</span> <span class="token function">sudo</span> gpg <span class="token parameter variable">--dearmor</span> <span class="token parameter variable">-o</span> /usr/share/keyrings/caddy-stable-archive-keyring.gpg
<span class="token function">curl</span> <span class="token parameter variable">-1sLf</span> <span class="token string">'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/caddy-stable.list
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> caddy</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p>安装完成后在命令行输入</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash">caddy <span class="token parameter variable">-v</span> </code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/01/30/63d70e7863dc6.webp" alt="caddy-v"></p><p>检查Caddy是否成功安装，如果成功输出Caddy版本那就说明安装成功了！</p><h2 id="安装Artalk"><a href="#安装Artalk" class="headerlink" title="安装Artalk"></a>安装Artalk</h2><p>使用Docker运行部署需要在命令行输入</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
    <span class="token parameter variable">--name</span> artalk <span class="token punctuation">\</span>
    <span class="token parameter variable">-p</span> <span class="token number">8080</span>:23366 <span class="token punctuation">\</span>
    <span class="token parameter variable">-v</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>/data:/data <span class="token punctuation">\</span>
    artalk/artalk-go</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p>在执行完成后输入</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token function">ps</span></code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p>当显示以下界面就说明Artalk已经成功部署并运行</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/01/30/63d70e776f8d5.webp" alt="docker ps"></p><p>我们只需要开放 <code>8080</code> 端口通过IP访问，如果能成功访问并出现出现 Artalk 后台登陆界面就说明OK了</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/01/30/63d70e76e3734.webp" alt="ui"></p><p>然后我们输入一下命令去创建管理员账户</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash"><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> artalk artalk admin</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><h2 id="使用Caddy进行反代"><a href="#使用Caddy进行反代" class="headerlink" title="使用Caddy进行反代"></a>使用Caddy进行反代</h2><p>我们进入通过CD进入 <code>/etc/caddy/</code> 文件夹然后编辑 <code>Caddyfile</code> 文件</p><pre class="language-diff pre_code" data-language="diff"><code class="language-diff"># The Caddyfile is an easy way to configure your Caddy web server.
#
# Unless the file starts with a global options block, the first
# uncommented line is always the address of your site.
#
# To use your own domain name (with automatic HTTPS), first make
# sure your domain's A/AAAA DNS records are properly pointed to
# this machine's public IP, then replace ":80" below with your
# domain name.

:80 {
	# Set this path to your site's directory.
	root * /usr/share/caddy

	# Enable the static file server.
	file_server

	# Another common task is to set up a reverse proxy:
	# reverse_proxy localhost:8080

	# Or serve a PHP site through php-fpm:
	# php_fastcgi localhost:9000
}	
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> 你的域名 {
</span><span class="token prefix inserted">+</span><span class="token line"> 	reverse_proxy localhost:8080
</span><span class="token prefix inserted">+</span><span class="token line"> }</span></span></code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p>然后记得保存，我们在命令行中输入</p><pre class="language-bash pre_code" data-language="bash"><code class="language-bash">caddy reload</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/01/30/63d710b74700b.webp" alt="caddy reload"></p><p>去重启Caddy服务，然后访问 <code>https://你的域名</code> 即可</p><h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><ol><li>为什么我不用宝塔？宝塔虽然方便但个人认为宝塔问题比较多且还有广告影响体验</li><li>为什么我不用Nginx或Apache这种老牌站点管理器呢？因为Caddy简单易上手，而且能自动签发SSL证书，虽然Caddy性能并不出众但给个人使用还是绰绰有余了</li><li>为什么要用Artalk？因为Artalk功能相比于其他评论系统的功能是比较丰富，它不仅有评论功能还有PV统计、随机页面、随机评论等额外功能</li></ol><p><strong>参考：</strong></p><p><a target="_blank" rel="noopener" href="https://artalk.js.org/guide/deploy.html">部署Artalk</a><br><a target="_blank" rel="noopener" href="https://www.docker.com/">Docker安装</a><br><a target="_blank" rel="noopener" href="https://caddyserver.com/">Caddy使用</a></p></body></html></div><div class="comments_wrap"><div class="comments_top"><i class="ri-chat-3-line"></i><div class="comment_title">评论</div></div><div id="comments"></div></div></div></div></div></div></main><div><script src="https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js"></script><script>function Comments(){twikoo.init({envId:"https://rootlex.zeabur.app",el:"#comments",lang:"zh-CN"})}</script><script src="/js/lib/pjax.min.js"></script><script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.min.js"></script><script src="/js/lib/view-image.min.js"></script><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-y/aplayer/1.10.1/APlayer.min.js"></script><link href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-y/aplayer/1.10.1/APlayer.min.css" rel="stylesheet"><script src="https://cdn1.tianli0.top/npm/meting@2.0.1/dist/Meting.min.js"></script><script src="/js/main.js"></script><script>const pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:['meta[name="description"]',"title","#site-config",".index_content",".tab_warp"],cacheBust:!1,scrollRestoration:!1,analytics:!1});document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),a=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(a)),e.parentNode.replaceChild(t,e)})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/")}))</script><script>const posts=["posts/a61e63c2/","posts/c323bf04/","posts/b19848b6/","posts/6177b8b5/","posts/ec7d7221/","posts/80cfaa0f/","posts/7a70876f/","posts/8f292cc0/","posts/30e05efc/"];function toRandomPost(){pjax.loadUrl("/"+posts[Math.floor(Math.random()*posts.length)])}</script></div></body></html>