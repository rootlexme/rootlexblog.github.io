<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <title>
    Rootlex Blog
    
</title>
<noscript>开启Javascript是必要的</noscript>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta aria-description="">
<meta aria-keyshortcuts="">
<link href="/css/var.css" rel="stylesheet">
<link href="/fonts/remixicon.css" rel="stylesheet">
<link href="/css/main.css" rel="stylesheet">
<link href="/css/content.css" rel="stylesheet">

    <link href="/css/hightlight/theme.css" rel="stylesheet">



    <script>
        const GobalCofig = {
            codelimit: '300'
        }
    </script>
    <style>
        :root{
            --code-limit: 300px
        }
    </style>

<link href="https://cdn1.tianli0.top/npm/artalk@2.4.4/dist/Artalk.css" rel="stylesheet">
<script type="text/javascript" src="https://cdn1.tianli0.top/npm/artalk@2.4.4/dist/Artalk.js"></script>

    <meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Rootlex Blog" type="application/atom+xml">
</head>
    <body>
        <main class="layouts_warp">
            <div class="layouts_content">
                <div class="sidebar_main w-1-3" id="sidebar">
    <div class="site_name">
        <img src="/img/site.png" alt="网页标题">
    </div>
    <ul class="menu" id="menu">
        
            
            <li class="menu_list">
                <a href="/" class="menu_item">
                    <i class="ri-home-6-line"></i>
                    <span class="menu_item_span">
                        主页
                    </span>
                </a>
            </li>
        
            
            <li class="menu_list">
                <a href="/says/" class="menu_item">
                    <i class="ri-message-3-line"></i>
                    <span class="menu_item_span">
                        闲言碎语
                    </span>
                </a>
            </li>
        
            
            <li class="menu_list">
                <a href="/bgm/" class="menu_item">
                    <i class="ri-movie-2-line"></i>
                    <span class="menu_item_span">
                        追番
                    </span>
                </a>
            </li>
        
            
            <li class="menu_list">
                <a href="/friends/" class="menu_item">
                    <i class="ri-links-line"></i>
                    <span class="menu_item_span">
                        朋友们
                    </span>
                </a>
            </li>
        
            
            <li class="menu_list">
                <a href="/fc/" class="menu_item">
                    <i class="ri-heart-line"></i>
                    <span class="menu_item_span">
                        朋友圈
                    </span>
                </a>
            </li>
        
    </ul>
<!--    <hr>-->
    <hr>

    <div class="tab_warp">
      <input type="radio" name="side-tab" class="tab-radio-tj" id="card-selector-tj" checked>
      <input type="radio" name="side-tab" class="tab-radio-toc" id="card-selector-toc">
      <div class="tab_selector">
        <label for="card-selector-tj" class="tab-handler-tj">统计</label>
        <label for="card-selector-toc" class="tab-handler-toc">目录</label>
      </div>
      <div class="tab_content">
        <div class="tab_content-tj">
            <div class="statistics_item">
              <span class="statistics_span">
                文章
              </span>
              <span class="statistics_num">
                8 篇
              </span>
            </div>
            <div class="statistics_item">
              <span class="statistics_span">
                分类
              </span>
              <span class="statistics_num">
                3
              </span>
            </div>
            <div class="statistics_item">
              <span class="statistics_span">
                字数
              </span>
              <span class="statistics_num">
                7.9k
              </span>
            </div>
            <div class="statistics_item">
              <span class="statistics_span">
                运行
              </span>
              <span class="statistics_num">
                358 天
              </span>
            </div>
          </div>
        <div class="tab_content-toc">
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%86%E5%A4%87"><span class="toc-text">准备</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A3%E6%96%87%E7%B4%A2%E5%BC%95"><span class="toc-text">正文索引</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-text">正文</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8EGitHub%E5%85%8B%E9%9A%86%E4%BB%A3%E7%A0%81"><span class="toc-text">从GitHub克隆代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8CUnpkg"><span class="toc-text">运行Unpkg</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%9A%E4%B8%BB%E7%9A%84unpkg%E9%95%9C%E5%83%8F"><span class="toc-text">博主的unpkg镜像</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%90%8E%E9%9D%A2"><span class="toc-text">写在后面</span></a></li></ol>
        </div>
      </div>
    </div>


    <div class="connect">
        
            
            <a target="_blank" rel="noopener" href="https://space.bilibili.com/494271806" style="color: #00b1ff" aria-label="bilibili">
                <i class="ri-bilibili-fill"></i>
            </a>
        
            
            <a target="_blank" rel="noopener" href="https://github.com/rootlexblog" style="color: black" aria-label="github">
                <i class="ri-github-fill"></i>
            </a>
        
            
            <a target="_blank" rel="noopener" href="https://music.163.com/#/user/home?id=3416536539" style="color: #ff3030" aria-label="网易云">
                <i class="ri-netease-cloud-music-fill"></i>
            </a>
        
            
            <a href="mailto:a@nalex.top" style="color: #ffc952" aria-label="邮箱">
                <i class="ri-mail-send-line"></i>
            </a>
        
    </div>
    <div class="copyright">
        <i class="ri-copyright-line"></i>
        <span>2023</span>
        <a href="/">Rootlex</a>
    </div>
</div>

                <div class="layouts_page_content w-2-3">
                    <div class="nav hide" id="nav">
    <div class="nav_item">
      <a href="/" aria-label="主页" class="home">
        <i class="ri-home-6-line"></i>
      </a>
      <a class="rand_page" aria-label="随机页面">
        <i class="ri-shuffle-line"></i>
      </a>
      <div class="mobile_nav_item">
        
          
          <a class="menu_item" href="/" aria-label="主页">
            <i class="ri-home-6-line"></i>
          </a>
        
          
          <a class="menu_item" href="/says/" aria-label="闲言碎语">
            <i class="ri-message-3-line"></i>
          </a>
        
          
          <a class="menu_item" href="/bgm/" aria-label="追番">
            <i class="ri-movie-2-line"></i>
          </a>
        
          
          <a class="menu_item" href="/friends/" aria-label="朋友们">
            <i class="ri-links-line"></i>
          </a>
        
          
          <a class="menu_item" href="/fc/" aria-label="朋友圈">
            <i class="ri-heart-line"></i>
          </a>
        
      </div>
    </div>
    <div class="nav_item">
      <a href="/atom.xml" aria-label="rss" target="_blank">
        <i class="ri-rss-fill"></i>
      </a>
      <a target="_blank" rel="noopener" href="https://www.travellings.cn/go.html" aria-label="开往">
        <i class="ri-subway-fill"></i>
      </a>
    </div>
</div>

                    <div class="content_top">
    <div class="top_img">
        <img src="/img/topimg.webp" alt="顶部头图" class="top_img_a">
        <div class="me">
            <span>Rootlex</span>
            <img src="/img/avatar.webp" alt="头像" class="avatar">
        </div>
    </div>
    <div class="top_bar">
        <div class="cate_list" id="cate">
            <a class="cate_item" href="/">主页</a>
            <div class="cate_list_item">
                
                    <a class="cate_item" href="/categories/教程/">教程</a>
                
                    <a class="cate_item" href="/categories/折腾/">折腾</a>
                
                    <a class="cate_item" href="/categories/笔记/">笔记</a>
                
            </div>
        </div>
        <div class="bar_dec">
            <span>寒蝉黎明之时，便是重生之日</span>
        </div>
    </div>
</div>


                    <div class="index_content">
                        <div class="index_content_list_item">
    <div class="content_author">
    <img src="/img/avatar.webp" alt="头像">
    <div class="content_author_item">
      <span class="name">Rootlex</span>
      <div class="date" >2022-01-23</div>
    </div>
</div>

    <div class="post_info">
        如何部署unpkg至服务器
    </div>
    <div class="content_g">
        <html><head></head><body><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>unpkg 是一个前端常用的公共CDN，用来解包npm，但是有时会出现无法访问的状况。因为unpkg是一个开源项目，所以我们可以自己动手部署一个unpkg在自己的服务器上。</p>
<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><ol>
<li>一台Linux服务器</li>
<li>ssh工具</li>
<li>一台能联网的电脑</li>
</ol>
<h1 id="正文索引"><a href="#正文索引" class="headerlink" title="正文索引"></a>正文索引</h1><ol>
<li>安装nodejs</li>
<li>从GitHub克隆Unpkg源码</li>
<li>运行Unpkg</li>
</ol>
<hr>
<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>安装完宝塔面板后，得先检查是否开启防火墙的<code>8888</code>端口<br>腾讯云轻量为例，我们点开实例<br><img src="https://bu.dusays.com/2022/01/23/42c8b7d7d9c1a.png" alt="firewall.png"></p>
<p>点<code>防火墙</code> 然后点<code>添加规则</code><br><img src="https://bu.dusays.com/2022/01/23/42c8b7d7d9c1a.png" alt="creatfirewall.png"></p>
<p>在端口输入<code>8888</code> 然后点确定之后登录你的宝塔面板<br><img src="https://bu.dusays.com/2022/04/05/86e3861a94e56.png" alt="btnode.png"></p>
<p>依次点击<code>网站</code>，然后点击<code>node</code><br>初次安装需要安装node环境，按照给的提示做就行</p>
<p><img src="https://bu.dusays.com/2022/04/05/b9c26ba86b003.png" alt="nodev"></p>
<p>在选择版本这里选<code>16.13.2</code> （其他版本博主没有测试过，所以有可能会出现问题）</p>
<h2 id="从GitHub克隆代码"><a href="#从GitHub克隆代码" class="headerlink" title="从GitHub克隆代码"></a>从GitHub克隆代码</h2><p>点击<code>终端</code><br><img src="https://bu.dusays.com/2022/01/23/d60b4aea7fc17.png" alt="zhongdaunbt"><br>输入</p>
<pre class="language-none pre_code"><code class="language-none">git clone https://github.com/mjackson/unpkg.git</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre>
<p>完成克隆后输入命令</p>
<pre class="language-none pre_code"><code class="language-none">pwd</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre>

<p>注意这是centos的命令，其他系统可以上百度查询</p>
<p>记下输出的路径，这样子可以方便后面找这个文件<br><img src="https://bu.dusays.com/2022/01/23/7616e6932f703.png" alt="pwd"></p>
<h2 id="运行Unpkg"><a href="#运行Unpkg" class="headerlink" title="运行Unpkg"></a>运行Unpkg</h2><p>由于unpkg部署在cloudflare上所在unpkg源码中有关于cloudflare由于我们没有使用cloudflare，所以我们要删除相关组件<br>我们找到<code>modules/createServer.js</code><br>然后删除以下两行代码</p>
<pre class="language-diff pre_code" data-language="diff"><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import serveStats from './actions/serveStats.js';
</span><span class="token prefix deleted">-</span><span class="token line"> app.get('/api/stats', serveStats);</span></span></code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre>
<p>接下来我们得要重新构建node项目<br>首先我们得要下载构建依赖，在终端输入</p>
<pre class="language-none pre_code"><code class="language-none">npm i rollup</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre>
<p>然后我们编辑<code>package.json</code>  ，在<code>"postinstall": "yarn run build",</code>下面添加<code>"start": "set NODE_ENV=production&amp;&amp;node server.js"</code></p>
<pre class="language-DIFF pre_code" data-language="DIFF"><code class="language-DIFF">{
  "name": "unpkg",
  "private": true,
  "description": "The CDN for everything on npm",
  "scripts": {
    "build": "rollup -c",
    "clean": "git clean -e '!/.env' -fdX .",
    "lint": "eslint .",
    "serve": "nodemon -w server.js server.js",
    "test": "jest",
    "watch": "rollup -c -w",
    "postinstall": "yarn run build",
+   "start": "set NODE_ENV=production&amp;&amp;node server.js"
  },
  "depen</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre>
<p>然后在Unpkg文件位置打开终端输入</p>
<pre class="language-none pre_code"><code class="language-none">npm run build</code><div class="code-expand-btn"><i class="ri-arrow-drop-down-line"></i></div></pre>
<p><img src="https://bu.dusays.com/2022/01/23/f52abbe8145b5.png" alt="npm run build"><br>等待其生成<code> server.js</code><br>接下来我们回到<code> 网站</code>然后点击<code> node项目</code>，接下来点击<code> 添加node项目</code></p>
<ol>
<li>项目地址：unpkg的根目录</li>
<li>项目名称：随便输一个就行</li>
<li>启动选项：选择<code> strat ...</code></li>
<li>项目端口：填<code> 8080</code></li>
<li>运行用户：选<code> www</code>就行了</li>
<li>node版本： 你的node版本</li>
<li>绑定域名：你的域名 &amp; 如果没有就输入服务器ip</li>
</ol>
<p><img src="https://bu.dusays.com/2022/04/05/7ebe5ae13ef84.png" alt="npmsetting"><br>接下来点击<code>提交</code><br>然后我们点击<code>设置</code><br><img src="https://bu.dusays.com/2022/01/23/3b1de8166921d.png" alt="nodesetting"><br>然后点击<code> 外网映射</code>，开启<code> 外网映射</code><br>然后我们点击运行状态下面显示的<code>未启动</code>,将它启动<br><img src="https://bu.dusays.com/2022/01/23/1c81d84eb0aaa.png" alt="run"><br>接下来我们<strong>打开<code>8080</code>防火墙</strong>然后访问就可以啦<br>地址：你的域名<br><img src="https://bu.dusays.com/2022/04/05/14f9538a8ccbe.png" alt="unpkg"><br>如果你觉得速度不行可以自己套cdn</p>
<h1 id="博主的unpkg镜像"><a href="#博主的unpkg镜像" class="headerlink" title="博主的unpkg镜像"></a>博主的unpkg镜像</h1><p>已失效</p>
<h1 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h1><p>本文参考了一下前辈的文章</p>
<ol>
<li>删减cloufalre配置项 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/rongfengliang/p/14410193.html">https://www.cnblogs.com/rongfengliang/p/14410193.html</a></li>
<li>添加<code>package.json</code>启动代码 <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39868248/article/details/111621946">https://blog.csdn.net/weixin_39868248/article/details/111621946</a></li>
</ol>
<p>非常感谢！！！！💕</p>
</body></html>
    </div>
    <div class="comments_top">
    <i class="ri-chat-3-line"></i>
    <div class="comment_title">评论</div>
</div>
<div id="Comments"></div>
<script>
    function Comments(){
        new Artalk({
            el:        '#Comments',
            pageKey:   'https://blog.nalex.top/posts/8f292cc0/',
            pageTitle: '如何部署unpkg至服务器',
            server:    'https://artalk.yj.al/',
            site:      'Rootlex 的博客',
        })
    }
    Comments()
    document.addEventListener("pjax:complete", () => {
        Comments()
    })
</script>

</div>

                    </div>
                </div>
            </div>
        </main>
        <script type="text/javascript" src="/js/main.js"></script>

    <script type="text/javascript" src="/js/lib/pjax.min.js"></script>
    <script>
        const pjax = new Pjax({
            elements: 'a:not([target="_blank"])',
            selectors: [
                '.index_content',
                // '.atk-layer-wrap',
                '.tab_warp',
                '.js-pjax'
            ],
            cacheBust: false,
            scrollRestoration: false,
            analytics: false,
        })
        document.addEventListener("pjax:complete", () => {
            whenDOMReady()
        })
    </script>
    <div class="js-pjax">
        <script>
            
                toc.init()
            
        </script>
    </div>


    </body>
</html>
